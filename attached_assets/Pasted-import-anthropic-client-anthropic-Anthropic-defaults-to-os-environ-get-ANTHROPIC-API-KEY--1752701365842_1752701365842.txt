import anthropic

client = anthropic.Anthropic(
    # defaults to os.environ.get("ANTHROPIC_API_KEY")
    api_key="my_api_key",
)

# Replace placeholders like {{PATIENT_HISTORY}} with real values,
# because the SDK does not support variables.
message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=20000,
    temperature=1,
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "<examples>\n<example>\n<PATIENT_HISTORY>\nPatient: Jane Doe\nDOB: 05/15/1975\nGender: Female\nMedical Record Number: MRN123456\n\nPast Medical History:\n- Type 2 Diabetes Mellitus (diagnosed 2010)\n- Hypertension (diagnosed 2012)\n- Hyperlipidemia (diagnosed 2015)\n- Obesity (BMI 32.5)\n\nSurgical History:\n- Appendectomy (1995)\n- Cesarean section (2005)\n\nMedications:\n- Metformin 1000mg BID\n- Lisinopril 10mg daily\n- Atorvastatin 20mg daily\n\nAllergies:\n- Penicillin (hives)\n\nSocial History:\n- Non-smoker\n- Occasional alcohol use\n- Sedentary lifestyle\n\nFamily History:\n- Father: Myocardial infarction at age 62\n- Mother: Type 2 Diabetes\n\nLast Visit (3 months ago):\n- Chief complaint: Fatigue and polyuria\n- Vital signs: BP 138/88, HR 78, RR 16, Temp 98.6°F, SpO2 98%\n- Physical exam: Unremarkable\n- Labs: HbA1c 7.8%, Fasting glucose 145 mg/dL, LDL 110 mg/dL\n- Assessment: Suboptimal diabetes control\n- Plan: Increase Metformin to 1000mg BID, lifestyle counseling, follow-up in 3 months\n</PATIENT_HISTORY>\n<CURRENT_VISIT_DATA>\nDate: 07/15/2023\nProvider: Dr. Emily Johnson\n\nChief Complaint: Follow-up for diabetes management\n\nHistory of Present Illness:\nPatient reports improved energy levels and decreased urinary frequency. She has been adherent to medication regimen and has made efforts to improve diet and increase physical activity. No complaints of hypoglycemia or other adverse effects from medication change.\n\nVital Signs:\n- BP: 132/82 mmHg\n- HR: 72 bpm\n- RR: 16 breaths/min\n- Temp: 98.4°F\n- SpO2: 99% on room air\n- Weight: 185 lbs (down 5 lbs from last visit)\n- BMI: 31.8\n\nPhysical Examination:\n- General: Alert, oriented, well-appearing\n- HEENT: Normocephalic, atraumatic. PERRLA. Oropharynx clear.\n- Cardiovascular: Regular rate and rhythm, no murmurs\n- Respiratory: Clear to auscultation bilaterally\n- Abdomen: Soft, non-tender, non-distended\n- Extremities: No edema, pulses intact\n\nLaboratory Results:\n- HbA1c: 7.2%\n- Fasting glucose: 128 mg/dL\n- LDL: 98 mg/dL\n- Creatinine: 0.9 mg/dL\n- eGFR: >60 mL/min/1.73m²\n\nAssessment:\n1. Type 2 Diabetes Mellitus - Improved control\n2. Hypertension - Well-controlled\n3. Hyperlipidemia - Improved\n4. Obesity - Mild improvement\n\nPlan:\n1. Continue current medications\n2. Encourage continued lifestyle modifications\n3. Follow-up in 3 months with repeat HbA1c and lipid panel\n4. Referral to nutritionist for further dietary counseling\n</CURRENT_VISIT_DATA>\n<ideal_output>\n<patient_update>\n**Patient Update: Jane Doe (MRN123456)**\n**Current Visit: 07/15/2023**\n\n**Summary of Changes Since Last Visit (3 months ago):**\nPatient demonstrates significant improvement in diabetes management with notable clinical and laboratory improvements. Key positive changes include symptom resolution, weight loss, improved glycemic control, and better lipid profile.\n\n**Current Symptoms:**\nPatient reports marked improvement in previously reported symptoms. Fatigue has resolved with improved energy levels, and polyuria (excessive urination) has significantly decreased. Patient denies hypoglycemic episodes or adverse medication effects. No new symptoms reported.\n\n**Treatment Response:**\nExcellent response to current medication regimen. Patient demonstrates good adherence to Metformin 1000mg BID as prescribed. Lifestyle modifications including dietary improvements and increased physical activity have been successfully implemented and are contributing to overall improvement.\n\n**Vital Signs:**\n- Blood pressure improved from 138/88 to 132/82 mmHg, indicating better hypertensive control\n- Heart rate stable at 72 bpm (previously 78 bpm)\n- Respiratory rate unchanged at 16 breaths/min\n- Temperature stable at 98.4°F\n- Oxygen saturation improved to 99% (previously 98%)\n- Significant weight loss of 5 pounds (current weight 185 lbs)\n- BMI decreased from 32.5 to 31.8, showing progress in obesity management\n\n**Physical Examination Findings:**\nCurrent physical examination remains unremarkable and consistent with previous visit. Patient appears well with normal cardiovascular, respiratory, and abdominal findings. No new abnormalities detected. Alert and oriented mental status maintained.\n\n**Overall Status Change:**\nPatient shows substantial improvement across multiple conditions. Diabetes control has improved significantly with HbA1c decreasing from 7.8% to 7.2% and fasting glucose dropping from 145 to 128 mg/dL. Hyperlipidemia management has improved with LDL cholesterol decreasing from 110 to 98 mg/dL. Hypertension remains well-controlled with improved blood pressure readings. Weight loss efforts are showing positive results. Kidney function remains stable with normal creatinine and eGFR values. Patient demonstrates excellent treatment compliance and motivation for continued lifestyle modifications.\n\n**Clinical Impression:** Patient is responding well to current treatment plan with improved diabetic control, stable hypertension management, and progress in weight reduction goals. Continue current therapeutic approach with ongoing lifestyle support.\n</patient_update>\n</ideal_output>\n</example>\n<example>\n<PATIENT_HISTORY>\nPatient: Michael Smith\nDOB: 09/23/1982\nGender: Male\nMedical Record Number: MRN789012\n\nPast Medical History:\n- Asthma (diagnosed 2000)\n- Generalized Anxiety Disorder (diagnosed 2015)\n- Gastroesophageal Reflux Disease (GERD) (diagnosed 2018)\n\nSurgical History:\n- Tonsillectomy (1990)\n\nMedications:\n- Albuterol inhaler PRN\n- Fluoxetine 20mg daily\n- Omeprazole 20mg daily\n\nAllergies:\n- Sulfa drugs (rash)\n\nSocial History:\n- Former smoker (quit 2019)\n- Social alcohol use\n- Works as a software engineer\n\nFamily History:\n- Mother: Breast cancer at age 55\n- Father: Hypertension\n\nLast Visit (2 months ago):\n- Chief complaint: Worsening anxiety and difficulty sleeping\n- Vital signs: BP 128/78, HR 88, RR 18, Temp 98.2°F, SpO2 99%\n- Physical exam: Anxious affect, otherwise unremarkable\n- Assessment: Exacerbation of Generalized Anxiety Disorder\n- Plan: Increase Fluoxetine to 30mg daily, refer to cognitive behavioral therapy, follow-up in 2 months\n</PATIENT_HISTORY>\n<CURRENT_VISIT_DATA>\nDate: 08/10/2023\nProvider: Dr. Sarah Thompson\n\nChief Complaint: Follow-up for anxiety management\n\nHistory of Present Illness:\nPatient reports improvement in anxiety symptoms and sleep quality since increasing Fluoxetine dosage. He has attended three cognitive behavioral therapy sessions and finds them helpful. Reports occasional breakthrough anxiety but overall feels more in control. No side effects from medication change noted.\n\nVital Signs:\n- BP: 122/76 mmHg\n- HR: 72 bpm\n- RR: 16 breaths/min\n- Temp: 98.6°F\n- SpO2: 99% on room air\n- Weight: 170 lbs (unchanged from last visit)\n- BMI: 24.4\n\nPhysical Examination:\n- General: Alert, oriented, calm demeanor\n- HEENT: Normocephalic, atraumatic. PERRLA. Oropharynx clear.\n- Cardiovascular: Regular rate and rhythm, no murmurs\n- Respiratory: Clear to auscultation bilaterally, no wheezes\n- Abdomen: Soft, non-tender, non-distended\n- Psychiatric: Euthymic mood, appropriate affect\n\nScreening:\n- GAD-7 score: 8 (down from 15 at last visit)\n- PHQ-9 score: 6 (down from 10 at last visit)\n\nAssessment:\n1. Generalized Anxiety Disorder - Improved with medication adjustment and therapy\n2. Asthma - Stable, no recent exacerbations\n3. GERD - Well-controlled on current medication\n\nPlan:\n1. Continue Fluoxetine 30mg daily\n2. Maintain current medications for asthma and GERD\n3. Encourage continuation of cognitive behavioral therapy\n4. Follow-up in 3 months or sooner if symptoms worsen\n5. Provided refills for all current medications\n</CURRENT_VISIT_DATA>\n<ideal_output>\n<patient_update>\n**Patient Update: Michael Smith (MRN789012)**\n**Current Visit: 08/10/2023**\n\n**Summary of Changes Since Last Visit (2 months ago):**\nPatient demonstrates significant improvement in anxiety management following medication adjustment and initiation of cognitive behavioral therapy. GAD-7 score decreased from 15 to 8, and PHQ-9 score improved from 10 to 6, indicating substantial reduction in anxiety and depressive symptoms.\n\n**Current Symptoms:**\nPatient reports marked improvement in anxiety symptoms and sleep quality since last visit. Experiences only occasional breakthrough anxiety episodes but feels more in control overall. No adverse effects reported from the increased Fluoxetine dosage (20mg to 30mg daily). No current complaints related to asthma or GERD.\n\n**Treatment Response:**\nExcellent response to increased Fluoxetine dosage (30mg daily) with no reported side effects. Patient has actively engaged in cognitive behavioral therapy, completing three sessions with reported benefit. Current medication regimen for asthma and GERD remains effective with no recent exacerbations or symptoms.\n\n**Vital Signs:**\nStable and improved vital signs compared to last visit:\n- Blood pressure: 122/76 mmHg (decreased from 128/78)\n- Heart rate: 72 bpm (decreased from 88)\n- Respiratory rate: 16 breaths/min (decreased from 18)\n- Temperature: 98.6°F (stable)\n- Oxygen saturation: 99% on room air (stable)\n- Weight: 170 lbs (unchanged)\n- BMI: 24.4 (normal range)\n\n**Physical Examination Findings:**\nSignificant improvement in psychiatric presentation with patient displaying calm demeanor and euthymic mood, contrasting with anxious affect noted at previous visit. All other systems remain stable with normal cardiovascular, respiratory, and abdominal examinations. No acute findings identified.\n\n**Overall Status Change:**\nPatient shows marked clinical improvement with effective anxiety management through combination therapy. All chronic conditions (GAD, asthma, GERD) are currently well-controlled. The treatment plan has been successful, allowing for extended follow-up interval from 2 to 3 months, indicating clinical stability and confidence in current management approach.\n</patient_update>\n</ideal_output>\n</example>\n</examples>\n\n"
                },
                {
                    "type": "text",
                    "text": "You are an AI medical assistant tasked with providing comprehensive updates on a patient's condition since their last visit. Your role is to analyze the patient's history and current visit data, then generate a clear and concise report for healthcare professionals.\n\nFirst, review the patient's previous history:\n\n<patient_history>\n{{PATIENT_HISTORY}}\n</patient_history>\n\nNow, examine the data from the current visit:\n\n<current_visit_data>\n{{CURRENT_VISIT_DATA}}\n</current_visit_data>\n\nAnalyze the information provided, comparing the current visit data with the patient's history. Focus on identifying changes, improvements, or deteriorations in the patient's condition. Pay particular attention to:\n\n1. Current symptoms and their severity\n2. Response to prescribed treatments\n3. Vital signs and any significant changes\n4. Physical examination findings\n5. Overall changes in the patient's status\n\nBased on your analysis, compose a comprehensive update on the patient's condition. Structure your update as follows:\n\n1. Summary of changes since last visit\n2. Current symptoms\n3. Treatment response\n4. Vital signs\n5. Physical examination findings\n6. Overall status change\n\nEnsure your update is clear, concise, and medically accurate. Use professional medical terminology where appropriate, but also provide explanations that would be understandable to other healthcare professionals who may not be specialists in this particular field.\n\nPresent your final update within <patient_update> tags. Your output should consist of only the patient update; do not include any analysis or thought process outside of these tags."
                }
            ]
        }
    ]
)
print(message.content)