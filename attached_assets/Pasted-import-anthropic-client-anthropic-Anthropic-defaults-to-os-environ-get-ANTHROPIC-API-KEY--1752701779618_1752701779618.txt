import anthropic

client = anthropic.Anthropic(
    # defaults to os.environ.get("ANTHROPIC_API_KEY")
    api_key="my_api_key",
)

# Replace placeholders like {{PATIENT_RECORD}} with real values,
# because the SDK does not support variables.
message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=20000,
    temperature=1,
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "<examples>\n<example>\n<PATIENT_RECORD>\nPatient ID: 12345678\nAdmission Date: 05/15/2023\nDischarge Date: 05/22/2023\n\nAdmission Notes:\n68-year-old male presented to the ER with severe chest pain and shortness of breath. ECG showed ST-segment elevation consistent with acute myocardial infarction. Patient was admitted to the Cardiac Care Unit for further management.\n\nMedical History: Hypertension, Type 2 Diabetes, Hyperlipidemia\n\nCourse of Stay:\n05/15/2023: Patient underwent emergency cardiac catheterization with placement of two drug-eluting stents in the left anterior descending artery. Post-procedure, patient was started on dual antiplatelet therapy and continued on beta-blockers and ACE inhibitors.\n\n05/16/2023 - 05/18/2023: Patient remained in CCU for close monitoring. Experienced episodes of atrial fibrillation, managed with amiodarone. Troponin levels gradually decreased. Echocardiogram showed reduced left ventricular ejection fraction (LVEF) of 40%.\n\n05/19/2023 - 05/21/2023: Transferred to regular cardiac floor. Initiated on cardiac rehabilitation program. Patient educated on lifestyle modifications, medication adherence, and recognition of cardiac symptoms.\n\n05/22/2023: Patient stable and prepared for discharge.\n\nCurrent Medications:\n1. Aspirin 81mg daily\n2. Clopidogrel 75mg daily\n3. Metoprolol 25mg twice daily\n4. Lisinopril 10mg daily\n5. Atorvastatin 40mg daily\n6. Metformin 1000mg twice daily\n\nDischarge Plan:\n- Follow-up appointment with cardiologist in 2 weeks\n- Continue cardiac rehabilitation program (outpatient, 3 times per week for 12 weeks)\n- Home health nurse to visit twice weekly for 2 weeks to monitor vital signs and medication compliance\n- Strict diet and exercise regimen as per cardiac rehabilitation guidelines\n- Smoking cessation program referral\n\nDischarge Instructions:\n- Take all medications as prescribed\n- Monitor weight daily and report any sudden weight gain\n- Report any recurrence of chest pain, shortness of breath, or palpitations\n- Gradually increase physical activity as tolerated\n- Adhere to low-sodium, heart-healthy diet\n- No driving for 2 weeks\n- No heavy lifting (>10 lbs) for 4 weeks\n\nNext Appointment: Dr. Smith, Cardiology, 06/05/2023 at 10:00 AM\n</PATIENT_RECORD>\n<ideal_output>\n<patient_summary>\n<admission_reason>\nThe 68-year-old male patient was admitted to the hospital on 05/15/2023 due to severe chest pain and shortness of breath. An ECG revealed ST-segment elevation consistent with an acute myocardial infarction (heart attack), prompting immediate admission to the Cardiac Care Unit.\n</admission_reason>\n\n<treatments_received>\nThe patient received comprehensive cardiac care including emergency cardiac catheterization with stent placement, dual antiplatelet therapy, and cardiac medications (beta-blockers and ACE inhibitors). Episodes of atrial fibrillation were managed with amiodarone. The patient was closely monitored in the CCU for three days before being transferred to the regular cardiac floor, where cardiac rehabilitation was initiated along with patient education on lifestyle modifications and medication adherence.\n</treatments_received>\n\n<procedures_performed>\nEmergency cardiac catheterization was performed with placement of two drug-eluting stents in the left anterior descending artery. An echocardiogram was conducted to assess heart function, which revealed reduced left ventricular ejection fraction of 40%.\n</procedures_performed>\n\n<current_condition>\nThe patient is stable and ready for discharge. However, there are ongoing concerns including reduced heart function (LVEF 40%) and a history of atrial fibrillation during the hospital stay. Troponin levels have gradually decreased, indicating healing from the heart attack. The patient has existing medical conditions including hypertension, Type 2 diabetes, and hyperlipidemia that require continued management.\n</current_condition>\n\n<medications>\nCurrent medications include: Aspirin 81mg daily, Clopidogrel 75mg daily, Metoprolol 25mg twice daily, Lisinopril 10mg daily, Atorvastatin 40mg daily, and Metformin 1000mg twice daily. These medications address cardiac protection, blood pressure control, cholesterol management, and diabetes control.\n</medications>\n\n<discharge_planning>\nThe discharge plan includes a cardiology follow-up appointment in 2 weeks (06/05/2023), continuation of outpatient cardiac rehabilitation 3 times weekly for 12 weeks, and home health nursing visits twice weekly for 2 weeks to monitor vital signs and medication compliance. The patient has been referred to a smoking cessation program and must adhere to activity restrictions including no driving for 2 weeks and no heavy lifting over 10 pounds for 4 weeks. Daily weight monitoring, adherence to a low-sodium heart-healthy diet, and gradual increase in physical activity are emphasized, with instructions to report any concerning symptoms immediately.\n</discharge_planning>\n</patient_summary>\n</ideal_output>\n</example>\n<example>\n<PATIENT_RECORD>\nPatient ID: 87654321\nAdmission Date: 09/03/2023\nDischarge Date: 09/12/2023\n\nAdmission Notes:\n42-year-old female presented to the ER with severe abdominal pain, nausea, and fever. CT scan revealed acute appendicitis with signs of perforation. Patient admitted for emergency appendectomy.\n\nMedical History: Asthma, Hypothyroidism\n\nCourse of Stay:\n09/03/2023: Patient underwent laparoscopic appendectomy under general anesthesia. Procedure was uncomplicated. Post-op, patient transferred to surgical ward for recovery. IV antibiotics initiated.\n\n09/04/2023 - 09/06/2023: Patient experienced post-operative pain, managed with opioid analgesics. Gradual transition to oral intake. Mild wound infection noted on day 3, cultured and managed with targeted antibiotics.\n\n09/07/2023 - 09/09/2023: Patient's condition improved. Pain well-controlled with oral medications. Dietary intake increased. Physiotherapy initiated for early mobilization.\n\n09/10/2023 - 09/11/2023: Patient fully mobile. Wound healing well. Transitioned to oral antibiotics. Patient educated on wound care and post-operative recovery.\n\n09/12/2023: Patient stable and prepared for discharge.\n\nLab Results:\n09/03/2023: WBC 18.5, CRP 85\n09/06/2023: WBC 12.3, CRP 40\n09/10/2023: WBC 8.5, CRP 15\n\nCurrent Medications:\n1. Cefuroxime 500mg twice daily for 5 more days\n2. Acetaminophen 1000mg every 6 hours as needed for pain\n3. Levothyroxine 100mcg daily\n4. Salbutamol inhaler 2 puffs every 4-6 hours as needed\n\nDischarge Plan:\n- Follow-up appointment with surgeon in 2 weeks\n- Remove sutures in 10 days at local clinic\n- Gradually increase physical activity over next 4-6 weeks\n- Continue current medications as prescribed\n\nDischarge Instructions:\n- Take all medications as directed\n- Keep incision site clean and dry\n- No heavy lifting (>10 lbs) for 4 weeks\n- Report any fever, increased pain, redness, or discharge from incision site\n- Resume normal diet as tolerated\n- Return to work in 2-3 weeks, depending on job requirements\n\nNext Appointment: Dr. Johnson, General Surgery, 09/26/2023 at 2:00 PM\n</PATIENT_RECORD>\n<ideal_output>\n<patient_summary>\n<admission_reason>\n42-year-old female was admitted to the hospital on 09/03/2023 for severe abdominal pain, nausea, and fever. CT scan confirmed acute appendicitis with signs of perforation, requiring emergency surgical intervention.\n</admission_reason>\n\n<treatments_received>\nThe patient received intravenous antibiotics initially, followed by targeted antibiotics to treat a mild wound infection that developed on post-operative day 3. Pain management included opioid analgesics in the immediate post-operative period, with gradual transition to oral pain medications. Physiotherapy was initiated for early mobilization. The patient was gradually transitioned from IV to oral intake and eventually to a normal diet.\n</treatments_received>\n\n<procedures_performed>\nThe patient underwent an uncomplicated laparoscopic appendectomy under general anesthesia on 09/03/2023 to remove the perforated appendix.\n</procedures_performed>\n\n<current_condition>\nThe patient is stable and ready for discharge after a 9-day hospital stay. Laboratory values show significant improvement, with white blood cell count decreasing from 18.5 to 8.5 and C-reactive protein dropping from 85 to 15, indicating resolution of infection and inflammation. The surgical wound is healing well, and the patient is fully mobile with pain well-controlled on oral medications.\n</current_condition>\n\n<medications>\n1. Cefuroxime 500mg twice daily for 5 more days (antibiotic)\n2. Acetaminophen 1000mg every 6 hours as needed for pain\n3. Levothyroxine 100mcg daily (for pre-existing hypothyroidism)\n4. Salbutamol inhaler 2 puffs every 4-6 hours as needed (for pre-existing asthma)\n</medications>\n\n<discharge_planning>\nThe patient has a follow-up appointment with Dr. Johnson in General Surgery on 09/26/2023 at 2:00 PM. Sutures are to be removed in 10 days at a local clinic. Discharge instructions include taking all medications as directed, keeping the incision site clean and dry, avoiding heavy lifting over 10 pounds for 4 weeks, and gradually increasing physical activity over 4-6 weeks. The patient should return to work in 2-3 weeks depending on job requirements and report any concerning symptoms such as fever, increased pain, redness, or discharge from the incision site.\n</discharge_planning>\n</patient_summary>\n</ideal_output>\n</example>\n</examples>\n\n"
                },
                {
                    "type": "text",
                    "text": "You are an AI medical assistant tasked with summarizing a patient's entire hospital stay. Your goal is to provide a comprehensive yet concise overview of the patient's experience, from admission to discharge planning. \n\nHere is the patient's medical record:\n\n<patient_record>\n{{PATIENT_RECORD}}\n</patient_record>\n\nCarefully analyze the patient record and extract all relevant information. Your summary should include the following sections, each wrapped in appropriate XML tags:\n\n1. <admission_reason>: Briefly describe why the patient was admitted to the hospital.\n2. <treatments_received>: List and briefly explain the treatments the patient received during their stay.\n3. <procedures_performed>: Describe any medical procedures or surgeries performed on the patient.\n4. <current_condition>: Summarize the patient's current health status and any ongoing concerns.\n5. <medications>: List current medications, including dosages and frequencies if available.\n6. <discharge_planning>: Outline the plan for the patient's discharge, including follow-up appointments, home care instructions, or rehabilitation plans.\n\nWhen writing your summary:\n- Use clear, professional medical language, but avoid excessive jargon that might confuse non-medical professionals.\n- Be concise but thorough, ensuring all crucial information is included.\n- Maintain a neutral, objective tone throughout the summary.\n- Ensure all information is accurate and directly based on the provided patient record.\n- Do not include any speculative or assumed information not present in the record.\n- Maintain patient confidentiality by not including any identifying information beyond what is necessary for the summary.\n\nYour final output should be structured as follows:\n\n<patient_summary>\n<admission_reason>\n[Your content here]\n</admission_reason>\n\n<treatments_received>\n[Your content here]\n</treatments_received>\n\n<procedures_performed>\n[Your content here]\n</procedures_performed>\n\n<current_condition>\n[Your content here]\n</current_condition>\n\n<medications>\n[Your content here]\n</medications>\n\n<discharge_planning>\n[Your content here]\n</discharge_planning>\n</patient_summary>\n\nRemember, your final output should include only the content within the <patient_summary> tags. Do not include any additional commentary, notes, or the original patient record in your response."
                }
            ]
        }
    ]
)
print(message.content)